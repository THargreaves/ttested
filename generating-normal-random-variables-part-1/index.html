<!DOCTYPE html>
<html lang="en">
<head><meta name="generator" content="Hexo 3.9.0">
    <meta charset="utf-8">
<title>Generating Normal Random Variables - Part 1: Inverse Transform Sampling - T-Tested | Blogging about all things data</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">



    <meta name="description" content="The normal distribution is one of the most important developments in the history of statistics. As well as its useful statistical properties, it is so well-loved for its omnipresence in the natural wo">
<meta name="keywords" content="r,tutorial,simulation,normal-distribution">
<meta property="og:type" content="article">
<meta property="og:title" content="Generating Normal Random Variables - Part 1: Inverse Transform Sampling">
<meta property="og:url" content="https://www.ttested.com/generating-normal-random-variables-part-1/index.html">
<meta property="og:site_name" content="T-Tested | Blogging about all things data">
<meta property="og:description" content="The normal distribution is one of the most important developments in the history of statistics. As well as its useful statistical properties, it is so well-loved for its omnipresence in the natural wo">
<meta property="og:locale" content="en">
<meta property="og:image" content="https://www.ttested.com/gallery/thumbnails/generating-normal-random-variables-part-1.png">
<meta property="og:updated_time" content="2020-04-16T18:10:13.615Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Generating Normal Random Variables - Part 1: Inverse Transform Sampling">
<meta name="twitter:description" content="The normal distribution is one of the most important developments in the history of statistics. As well as its useful statistical properties, it is so well-loved for its omnipresence in the natural wo">
<meta name="twitter:image" content="https://www.ttested.com/gallery/thumbnails/generating-normal-random-variables-part-1.png">







<link rel="icon" href="/images/favicon.svg">


<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.7.2/css/bulma.css">
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.4.1/css/all.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Ubuntu:400,600|Source+Code+Pro">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css">


    
    
    
    <style>body>.footer,body>.navbar,body>.section{opacity:0}</style>
    

    
    
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css">
    

    
    

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.css">


    
    
    
    

<link rel="stylesheet" href="/css/back-to-top.css">


    
    
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-129615655-1"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-129615655-1');
</script>


    
    
    
    

    
    
<link rel="stylesheet" href="/css/progressbar.css">
<script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script>

    
    
    

    
    
    


<link rel="stylesheet" href="/css/style.css">
</head>
<body class="is-3-column">
    <nav class="navbar navbar-main">
    <div class="container">
        <div class="navbar-brand is-flex-center">
            <a class="navbar-item navbar-logo" href="/">
            
                <img src="/images/logo.png" alt="Generating Normal Random Variables - Part 1: Inverse Transform Sampling" height="28">
            
            </a>
        </div>
        <div class="navbar-menu">
            
            <div class="navbar-start">
                
                <a class="navbar-item" href="/">Home</a>
                
                <a class="navbar-item" href="/archives">Archives</a>
                
                <a class="navbar-item" href="/categories">Categories</a>
                
                <a class="navbar-item" href="/tags">Tags</a>
                
                <a class="navbar-item" href="/about">About</a>
                
            </div>
            
            <div class="navbar-end">
                
                    
                    
                    <a class="navbar-item" target="_blank" title="LinkedIn" href="https://www.linkedin.com/in/tim-hargreaves">
                        
                        <i class="fab fa-linkedin"></i>
                        
                    </a>
                    
                    <a class="navbar-item" target="_blank" title="GitHub" href="https://github.com/THargreaves">
                        
                        <i class="fab fa-github"></i>
                        
                    </a>
                    
                
                
                <a class="navbar-item is-hidden-tablet catalogue" title="Catalogue" href="javascript:;">
                    <i class="fas fa-list-ul"></i>
                </a>
                
                
                <a class="navbar-item search" title="Search" href="javascript:;">
                    <i class="fas fa-search"></i>
                </a>
                
            </div>
        </div>
    </div>
</nav>
    
    <section class="section">
        <div class="container">
            <div class="columns">
                <div class="column is-8-tablet is-8-desktop is-6-widescreen has-order-2 column-main"><div class="card">
    
    <div class="card-image">
        <span class="image is-7by1">
            <img class="thumbnail" src="/gallery/thumbnails/generating-normal-random-variables-part-1.png" alt="Generating Normal Random Variables - Part 1: Inverse Transform Sampling">
        </span>
    </div>
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2019-02-20T00:00:00.000Z">2019-02-20</time>
                
                <div class="level-item">
                <a class="has-link-grey -link" href="/categories/Statistics/">Statistics</a>&nbsp;/&nbsp;<a class="has-link-grey -link" href="/categories/Statistics/Probability/">Probability</a>
                </div>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    15 minutes read (About 2900 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                Generating Normal Random Variables - Part 1: Inverse Transform Sampling
            
        </h1>
        <div class="content">
            <h2 id="The-Importance-of-the-Normal-Distribution"><a href="#The-Importance-of-the-Normal-Distribution" class="headerlink" title="The Importance of the Normal Distribution"></a>The Importance of the Normal Distribution</h2><p>The normal (or Gaussian) distribution is arguably the most important and widely used probability distribution in the field of statistics. First studied in the early 18th century by Abraham de Moivre, a French mathematician (though later explored further by Karl Friedrich Gauss, hence the name), the distribution is so prevalent in probability theory due to its unique statistical properties which lead to it featuring heavily in many natural contexts. </p>
<p><img src="/images/generating-normal-random-variables-part-1/generating-normal-random-variables-part-1_4_0.svg" alt="Probability Density Functions for Various Normal Distributions"></p>
<p>One of the most important properties of the normal distribution is the central limit theorem. This states that if you take any sequence of independent, identically distributed random variables, calculate their partial sums and scale these so they are centred around zero and have unit variance, then the resulting random variable will have a distribution that is approximately normal. For example, if you were to flip a coin again and again until boredom forced you to stop, the resulting number of heads obtained (after appropriate scaling) would have an approximately normal distribution. Other examples of real life scenarios in which the normal distribution appears either approximately or exactly are:</p>
<ul>
<li>The distribution of heights and weights</li>
<li>The time it takes to travel to work</li>
<li>The volatility of stocks</li>
<li>The position of a diffusing particle relative to its starting point</li>
</ul>
<p>Since the normal distribution is so common in our statistical work and nature itself, it makes sense that we would want a method of generating our own normally distributed random variables. This is exactly what this series of blog posts is about.</p>
<h2 id="Generating-Normal-Random-Variables"><a href="#Generating-Normal-Random-Variables" class="headerlink" title="Generating Normal Random Variables"></a>Generating Normal Random Variables</h2><p>Anyone familiar with R may be wondering why this is a topic even worth discussing. After all, calling the built-in <code>rnorm()</code> function will give you as many normal random variables as you could possibly need with no effort required. And that is true; but how exactly does <code>rnorm()</code> give you these values? </p>
<p>As smart as your computer may be, it turns out that it does not have a way to directly generate normal random variables. In fact, all it can do is generate standard uniform variables - that is picking a number randomly from the interval <code>(0,1)</code>. Even then, technically, this is not a random process, rather pseudo-random - the algorithms designed to do this, however, are good enough that we’ll consider them random. It is then the job of cleverly designed statistical algorithms to take these standard uniform random variables and mutate them into the normal random variables that we require. This is exactly what <code>rnorm()</code> does, and by the end of this post you’ll understand roughly how.</p>
<p>Before we begin generating random variables which follow the normal distribution, it is worth noting that really there is no such thing as <em>the</em> normal distribution. In fact there are infinitely many such distributions (as shown above). Each of these is categorised uniquely by their mean and variance. However, due to another useful property of the normal distribution, if we wish to generate any normal random variable, the only difficult part is first calculating a <em>standard</em> normal random variable - that is, belonging to a normal distribution with mean zero and unit variance. Once we have this, we can use the property that if $Z$ is a normal random variable, then $X = \sigma Z + \mu$ is a normal random variable with mean $\mu$ and variance $\sigma^2$. </p>
<h2 id="Inverse-Transform-Sampling"><a href="#Inverse-Transform-Sampling" class="headerlink" title="Inverse Transform Sampling"></a>Inverse Transform Sampling</h2><h3 id="A-Theoretical-Background"><a href="#A-Theoretical-Background" class="headerlink" title="A Theoretical Background"></a>A Theoretical Background</h3><p>There are many different methods of generating normal random variables from a source of standard uniform variables many of which we will discuss in the following posts. The first of which and the subject of this post, is known as inverse transform sampling. The reason I have decided to start with this method, is that it is one of the simplest to introduce and its shortcomings lead on nicely to introducing alternative approaches.</p>
<p>Inverse transform sampling is a very versatile technique. Its use is not just limited to generating normal random variables but it can be used (in theory at least - we’ll see more about this later) to generate a random variable with any given distribution. All we need to know is the cumulative distribution function (CDF) of the random variable we are trying to generate. This is the function given by $F_X(x) = \mathbb{P}(X\leq x)$. </p>
<p>In order to utilise this CDF, along with our source of standard uniform random variables, to perform inverse transform sampling we first require its inverse. By definition of a CDF, we know that $F_X(x)$ is non-decreasing. Unfortunately, this alone cannot guarantee that $F_X(x)$ has a true inverse function; to be sure of this we require that $F_X(x)$ is strictly increasing. What we can do however is find a left-inverse, that is a function such that for any $u \in (0,1)$, $F_X\left(F_X^{-1}(u)\right) = u$. Specifically we can take $F_X^{-1}(u) = \textrm{inf}{x : F_X(x) \geq u }$. Although a true inverse is often easy to handle Mathematically, a left-inverse is sufficient for the requirements of inverse transform sampling. This fact is particularly important when the distribution we are trying to generate is discrete, in which case we are certain to not have a true inverse. </p>
<p>We now make the following observation:</p>
<p>$$<br>\begin{align}<br>&amp; \mathbb{P}(F_X^{-1}(U) \leq x) &amp; \\<br> &amp;= \mathbb{P}(U \leq F_X(x)) &amp; \textrm{[applying } F_X \textrm{ to both sides]} \\<br> &amp; = F_X(x) &amp;  \textrm{[since } \mathbb{P}(U\leq y) = y \textrm{ when } U \textrm{ is a standard uniform r.v.]}<br>\end{align}<br>$$</p>
<p>That is to say that $F_X^{-1}(U)$ and $X$ have the same distribution. Therefore, by taking our standard uniform samples and passing them through our inverse CDF, we can obtain new samples which will follow the target distribution that we were aiming to generate.</p>
<h3 id="The-Intuition"><a href="#The-Intuition" class="headerlink" title="The Intuition"></a>The Intuition</h3><p>If the last section seemed to go a bit too deep, don’t worry – understanding the theoretical underpinnings of inverse transform sampling is not necessary for its algorithmic implementation. The main take away is that if we can find an inverse (or near-inverse) function for our target CDF $F_X$ which we will denote $F_X^{-1}$, we can then generate our standard uniform random variables, pop them into our inverse CDF, and as if by magic, the resulting values will follow the distribution we were aiming to generate.</p>
<p>There is one problem though. This is all dependent on <em>if</em> we can find an inverse CDF. Furthermore, what if we can’t even find the CDF in the first place? It turns out that, although most of the distributions we care about have nice CDFs with computable inverses, the vast majority of random variables do not. When we do have a manageable CDF, we’re all set; inverse transform sampling will work perfectly and if our inverse CDF is easy to compute, will be highly efficient. If we can’t find such a CDF or its inverse, then we will have to consider other approaches.</p>
<h3 id="A-Concrete-Example"><a href="#A-Concrete-Example" class="headerlink" title="A Concrete Example"></a>A Concrete Example</h3><p>To demonstrate inverse transform sampling, we will apply it on a distribution which has a CDF suited to the method: the exponential distribution. The probability density function of an exponential random variable $X$ with rate parameter $\lambda$ is given by</p>
<p>$$<br>f_X(x)=<br>\begin{cases}<br>e^{-\lambda x} &amp; x &gt; 0\\<br>0 &amp; \textrm{otherwise}<br>\end{cases}<br>$$</p>
<p>And so integrating gives a CDF of </p>
<p>$$<br>F_X(x)=<br>\begin{cases}<br>1-e^{-\lambda x} &amp; x &gt; 0\\<br>0 &amp; \textrm{otherwise}<br>\end{cases}<br>$$</p>
<p>We then set $u = F_X(x)$ and solve for $x$ to get $F_X^{-1}(u) = -\frac{1}{\lambda}\ln(1-u)$. From the result above, this tells us that the random variable $-\frac{1}{\lambda}\ln(1-U)$ has the same distribution as $X$. Furthermore, since $U$ and $1-U$ have the same distribution, we can generate $X$ by using $-\frac{1}{\lambda}\ln(U)$.</p>
<p>We can see this in practice here.</p>
<figure class="highlight r hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">lambda &lt;- <span class="hljs-number">2</span></span><br><span class="line">U &lt;- runif(<span class="hljs-number">10000</span>)</span><br><span class="line">X_simulated &lt;- -<span class="hljs-number">1</span> / lambda * log(U)</span><br><span class="line">X_expected &lt;- rexp(<span class="hljs-number">10000</span>, lambda)</span><br><span class="line"></span><br><span class="line">par(mfrow = c(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>))</span><br><span class="line">hist(X_simulated, xlab = <span class="hljs-string">"X"</span>,</span><br><span class="line">     main = <span class="hljs-string">"Histrogram of simulated values"</span>,</span><br><span class="line">     breaks = <span class="hljs-number">10</span>, xlim = c(<span class="hljs-number">0</span>, <span class="hljs-number">5</span>))</span><br><span class="line">hist(X_expected, xlab = <span class="hljs-string">"X"</span>,</span><br><span class="line">     main = <span class="hljs-string">"Histrogram of expected values"</span>,</span><br><span class="line">     breaks = <span class="hljs-number">10</span>, xlim = c(<span class="hljs-number">0</span>, <span class="hljs-number">5</span>))</span><br></pre></td></tr></table></figure>




<p><img src="/images/generating-normal-random-variables-part-1/generating-normal-random-variables-part-1_10_0.svg" alt></p>
<p>The exponential distribution isn’t the only distribution that works well for inverse transform sampling. Here is a table of other distributions along with their PDFs, CDFs, and inverse CDFs, that can be effectively generated using inverse transform sampling.</p>
<style>
table {
    width: 100% !important;
}
th {
    text-align: center !important;
}
</style>

<table>
<thead>
<tr>
<th align="center">Distribution Name</th>
<th align="center">Probability Density Function</th>
<th align="center">Cumulative Density Function</th>
<th align="center">Inverse CDF</th>
</tr>
</thead>
<tbody><tr>
<td align="center">Pareto</td>
<td align="center">$\frac{\alpha \beta^\alpha}{x^{\alpha+1}}$</td>
<td align="center">$1 - \left(\frac{\beta}{x}\right)^\alpha$</td>
<td align="center">$\frac{\beta}{\sqrt[\leftroot{-3}\uproot{3}\alpha]{1-u}}$</td>
</tr>
<tr>
<td align="center">Cauchy</td>
<td align="center">$\frac{1}{\pi\gamma\left[1+\left(\frac{x-x_0}{\gamma}\right)^2\right]}$</td>
<td align="center">$\frac{1}{\pi}\arctan\left(\frac{x-x_0}{\gamma}\right) + \frac{1}{2}$</td>
<td align="center">$\gamma\tan\left(\pi\left(u-\frac{1}{2}\right)\right) + x_0$</td>
</tr>
<tr>
<td align="center">Logistic</td>
<td align="center">$\frac{1}{4}\textrm{sech}^2\left(\frac{x-\mu}{2s}\right)$</td>
<td align="center">$\frac{1}{s\left(1+e^{-\frac{x-\mu}{s}}\right)}$</td>
<td align="center">$\mu - s\log\left(\frac{1-u}{u}\right)$</td>
</tr>
<tr>
<td align="center">Rayleigh</td>
<td align="center">$\frac{x}{\sigma^2}e^\frac{-x^2}{2\sigma^2}$</td>
<td align="center">$1 - e^\frac{-x^2}{2\sigma^2}$</td>
<td align="center">$\sqrt{2\sigma^2\log\left(\frac{1}{1-u}\right)}$</td>
</tr>
</tbody></table>
<h3 id="Application-to-the-Normal-Distribution"><a href="#Application-to-the-Normal-Distribution" class="headerlink" title="Application to the Normal Distribution"></a>Application to the Normal Distribution</h3><p>With a simple example of inverse transform sampling under our belt, we can now turn our attention to the normal distribution. As mentioned in the introduction, it will suffice to generate random variables with a standard normal distribution and then scale them appropriately to obtain the distribution we were targeting. The cumulative density function of the standard normal distribution is given by</p>
<p>$$<br>f_X(x)=\frac{1}{\sqrt{2\pi}} e^{\frac{-x^2}{2}}<br>$$</p>
<p>This leads us into a problem. It can be shown that the integral $\int e^{-x^2} dx$ has no closed form using the standard elementary functions. That means that we have no way of finding a simple expression for the normal CDF. The normal distribution is simply just one of those many troublesome distributions for which inverse transform sampling is difficult. Since we can’t find a closed form the CDF we have very little chance of finding a nice way of expressing the inverse CDF that we need to implement the algorithm.</p>
<p>Thankfully though, we have a workaround. Although we are unable to find a closed form for the inverse CDF, it is not too hard to approximate it using numerical analysis. The exact details of the process are far beyond the scope of this post, revolving around Taylor series, convergence, and difference equations. All you need to know is that it is not too hard to approximate the inverse CDF we require using some carefully crafted polynomials. Using this trick, we can carry on just as if we have an explicit form for the CDf.</p>
<h2 id="Implementing-the-method"><a href="#Implementing-the-method" class="headerlink" title="Implementing the method"></a>Implementing the method</h2><h3 id="The-Algorithm"><a href="#The-Algorithm" class="headerlink" title="The Algorithm"></a>The Algorithm</h3><p>As mentioned in the previous section, we are forced to use an approximation for the inverse CDF of the normal distribution in order to implement this method. We could code this up ourselves but, luckily for us, R already has a built-in function which can do this for us. Specifically we will use the <code>qnorm()</code> function. This, given a vector of values between zero and one, will return for each element $u$, the value of the constant $x$ such that $\mathbb{P}(X\leq x) = u$. After a little thought, it should be clear that this is exactly the same process that our inverse CDF follows. Under the hood R uses the method we described above to generate these values - an approximation using carefully chosen polynomials. The raw source code for the <code>qnorm()</code> function can be found <a href="https://github.com/SurajGupta/r-source/blob/master/src/nmath/qnorm.c" target="_blank" rel="noopener">here</a> if you want to take a look at the internal workings.</p>
<p>Using this function to approximate our inverse CDF, the inverse transform sampling algorithm can be coded up in just a few lines.</p>
<figure class="highlight r hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">inverseTransform &lt;- <span class="hljs-keyword">function</span>(n = <span class="hljs-number">1</span>) &#123;</span><br><span class="line">    <span class="hljs-comment"># generate 'n' standard uniform samples</span></span><br><span class="line">    u &lt;- runif(n)</span><br><span class="line">    <span class="hljs-comment"># pass these samples through our inverse CDF</span></span><br><span class="line">    x &lt;- qnorm(u)</span><br><span class="line">    <span class="hljs-comment"># return the new, normally-distributed values</span></span><br><span class="line">    <span class="hljs-keyword">return</span>(x)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="Verification"><a href="#Verification" class="headerlink" title="Verification"></a>Verification</h3><p>We should now verify that the samples generated by this function are in fact normal. To do this we will begin by generating a thousand such samples.</p>
<figure class="highlight r hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment"># generate 1000 samples using our inverse transform sampling algorithm</span></span><br><span class="line">samples &lt;- inverseTransform(<span class="hljs-number">10</span>^<span class="hljs-number">3</span>)</span><br></pre></td></tr></table></figure>



<p>The first check we will perform is to plot the histogram for these values. We also overlay the expected density curve for the standard normal distribution.</p>
<figure class="highlight r hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment"># plot a histogram of our samples</span></span><br><span class="line">hist(samples, freq = <span class="hljs-literal">FALSE</span>)</span><br><span class="line"><span class="hljs-comment"># add a standard normal density curve</span></span><br><span class="line">densitySamps &lt;- seq(-<span class="hljs-number">4</span>, <span class="hljs-number">4</span>, by = <span class="hljs-number">0.01</span>)</span><br><span class="line">lines(densitySamps, dnorm(densitySamps), lwd = <span class="hljs-number">2</span>, col = <span class="hljs-string">"red"</span>)</span><br></pre></td></tr></table></figure>




<p><img src="/images/generating-normal-random-variables-part-1/generating-normal-random-variables-part-1_19_0.svg" alt></p>
<p>Looking good! Another visualisation we can use to verify normality is the normal <a href="https://en.wikipedia.org/wiki/Q%E2%80%93Q_plot" target="_blank" rel="noopener">Q-Q plot</a>. This compares the quantiles of our sample to the expected quantiles of a normal distribution. The closer to the diagonal line the points lie, the more likely it is that our samples are normally distributed.</p>
<figure class="highlight r hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">qqnorm(samples)</span><br><span class="line">qqline(samples)</span><br></pre></td></tr></table></figure>




<p><img src="/images/generating-normal-random-variables-part-1/generating-normal-random-variables-part-1_21_0.png" alt></p>
<p>That is a pretty much perfect Q-Q plot. There is some deviation from the diagonal at the tails of the distribution but that is to be expected since there are far fewer samples generated in those regions.</p>
<p>Lastly we can apply the <a href="https://en.wikipedia.org/wiki/Shapiro%E2%80%93Wilk_test" target="_blank" rel="noopener">Shapiro-Wilk test</a>. This is a hypothesis test which evaluates how likely it is that a collection of samples were drawn from a normal distribution.</p>
<figure class="highlight r hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">shapiro.test(samples)</span><br></pre></td></tr></table></figure>





<pre><code>    Shapiro-Wilk normality test

data:  samples
W = 0.99854, p-value = 0.5789</code></pre><p>The test statistic generated ranges from zero to one, a higher value indicating that the samples are more likely to be from a normal distribution. Here we obtained a value of greater than 0.99 which should fill us with confidence. If we so desired we could also use the <a href="https://en.wikipedia.org/wiki/Kolmogorov%E2%80%93Smirnov_test" target="_blank" rel="noopener">Kolmogorov-Smirnov test</a> - a hypothesis test similar to Shapiro-Wilk but that is non-parametric and generalises to comparing any two distributions - but by this point we already have a substantial amount of evidence that our generated samples are normally distributed. Success! </p>
<h3 id="Benchmarking"><a href="#Benchmarking" class="headerlink" title="Benchmarking"></a>Benchmarking</h3><p>Now that we know that our algorithm works as expected, we should also test its performance. We will do this by generating a large number of samples repeatedly and timing how long this takes. We will do this using the <code>rbenchmark</code> package. I have already written a <a href="https://www.ttested.com/blog/2018/09/22/removing-zero-variance-columns/">blog post</a> about this package detailing why I find it to be the best benchmarking package available in R, so I will not go into much depth on how it should be used. We will test our function by generating one million samples and repeating this one hundred times for a total of one hundred million samples.</p>
<figure class="highlight r hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">library</span>(rbenchmark)</span><br><span class="line">bm &lt;- benchmark(<span class="hljs-string">"Inverse Transform"</span> = inverseTransform(<span class="hljs-number">10</span>^<span class="hljs-number">6</span>),</span><br><span class="line">          columns = c(<span class="hljs-string">"test"</span>, <span class="hljs-string">"replications"</span>, <span class="hljs-string">"elapsed"</span>), </span><br><span class="line">          replications = <span class="hljs-number">100</span>)</span><br><span class="line">bm</span><br></pre></td></tr></table></figure>




<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script>$(document).ready( function () {$('#table0').DataTable();} );</script>
<table id="table0" class="display">

<thead>
    <tr><th scope="col">test</th><th scope="col">replications</th><th scope="col">elapsed</th></tr>
    <tr><th scope="col">&lt;fct&gt;</th><th scope="col">&lt;int&gt;</th><th scope="col">&lt;dbl&gt;</th></tr>
</thead>
<tbody>
    <tr><td>Inverse Transform</td><td>100</td><td>5.51</td></tr>
</tbody>
</table>



<p>As you can see in the table above, the one hundred million samples were generated in just a few seconds, showing incredible efficiency. </p>
<h2 id="Next-Steps-The-Box-Muller-Transform"><a href="#Next-Steps-The-Box-Muller-Transform" class="headerlink" title="Next Steps: The Box-Muller Transform"></a>Next Steps: The Box-Muller Transform</h2><p>Inverse transform sampling is an incredibly powerful tool. Even when dealing with troublesome distributions such as the normal distribution, by using appropriate approximations, we can still produce a working algorithm that generates samples with incredible speed. This method is so effective that, although implemented slightly differently, it is the exact procedure used by <code>rnorm()</code> to generate normally distributed samples in R. </p>
<p>Really, we could end this series of posts here; we have already derived one of the most effective methods for generating normal random variables. But it feels like a bit of a hollow victory. For a start, the algorithm we produced isn’t really <em>ours</em> - it is heavily dependant on the <code>qnorm()</code> function. And even if we were to code up our own function to approximate the inverse normal CDF, it will always be just that, an approximation. </p>
<p>There are many other methods of generating normal random variables. Many of these are exact methods, using no approximations. Others are capable of generating multi-dimensional normal random variables. Furthemore, a rare few can even perform better than the inverse transform sampling method that R uses. More importantly, by learning how these alternative methods work, we can discover new statistical concepts and see how they can be applied to solve real-world problems such as this. </p>
<p>The next method we will look at is the Box-Muller transform, a method for generating two-dimensional standard normal random variables using an ingenious pair of transformations. We will learn how this method works and how to implement it in R in the next blog post. But for now, the approximate method that inverse transform sampling offers us will have to do. </p>

        </div>
        
        <div class="level is-size-7 is-uppercase">
            <div class="level-start">
                <div class="level-item">
                    <span class="is-size-6 has-text-grey has-mr-7">#</span>
                    <a class="has-link-grey -link" href="/tags/normal-distribution/">normal-distribution</a>, <a class="has-link-grey -link" href="/tags/r/">r</a>, <a class="has-link-grey -link" href="/tags/simulation/">simulation</a>, <a class="has-link-grey -link" href="/tags/tutorial/">tutorial</a>
                </div>
            </div>
        </div>
        
        
        
    </div>
</div>





<div class="card card-transparent">
    <div class="level post-navigation is-flex-wrap is-mobile">
        
        <div class="level-start">
            <a class="level level-item has-link-grey  article-nav-prev" href="/integrating-hexo-and-jupyter/">
                <i class="level-item fas fa-chevron-left"></i>
                <span class="level-item">Integrating Hexo and Jupyter to Build a Data Science Blog</span>
            </a>
        </div>
        
        
        <div class="level-end">
            <a class="level level-item has-link-grey  article-nav-next" href="/google-interview-question/">
                <span class="level-item">Efficiently Solving a Google Coding Interview Question Using Pure Mathematics</span>
                <i class="level-item fas fa-chevron-right"></i>
            </a>
        </div>
        
    </div>
</div>



<div class="card">
    <div class="card-content">
        <h3 class="title is-5 has-text-weight-normal">Comments</h3>
        
<script>
    var disqus_config = function () {
        this.page.url = 'https://www.ttested.com/generating-normal-random-variables-part-1/';
        this.page.identifier = 'generating-normal-random-variables-part-1/';
    };
    (function() {
        var d = document, s = d.createElement('script');  
        s.src = '//' + 'ttested' + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>

<div id="disqus_thread">
    
    <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
    </div>
</div>
</div>
                




<div class="column is-4-tablet is-4-desktop is-3-widescreen  has-order-1 column-left ">
    
        
<div class="card widget">
    <div class="card-content">
        <nav class="level">
            <div class="level-item has-text-centered">
                <div>
                    
                        <figure class="image is-128x128 has-mb-6">
                            <img class="is-rounded" src="/images/avatar.png" alt="Tim Hargreaves">
                        </figure>
                    
                    
                    <p class="is-size-5 is-block">
                        Tim Hargreaves
                    </p>
                    
                    
                    <p class="is-size-6 is-block">
                        Data Scientist
                    </p>
                    
                    
                    <p class="is-size-6 is-flex is-flex-center has-text-grey">
                        <i class="fas fa-map-marker-alt has-mr-7"></i>
                        <span>AstraZeneca</span>
                    </p>
                    
                </div>
            </div>
        </nav>
        <nav class="level is-mobile">
            <div class="level-item has-text-centered is-marginless">
                <div>
                    <p class="heading">
                        Posts
                    </p>
                    <p class="title has-text-weight-normal">
                        32
                    </p>
                </div>
            </div>
            <div class="level-item has-text-centered is-marginless">
                <div>
                    <p class="heading">
                        Categories
                    </p>
                    <p class="title has-text-weight-normal">
                        19
                    </p>
                </div>
            </div>
            <div class="level-item has-text-centered is-marginless">
                <div>
                    <p class="heading">
                        Tags
                    </p>
                    <p class="title has-text-weight-normal">
                        40
                    </p>
                </div>
            </div>
        </nav>
        <div class="level">
            <a class="level-item button is-link is-rounded" href="https://mailchi.mp/b82eb9b2cffb/ttested" target="_blank">
                Subscribe</a>
        </div>
        
        
    </div>
</div>
    
        
<div class="card widget" id="toc">
    <div class="card-content">
        <div class="menu">
            <h3 class="menu-label">
                Catalogue
            </h3>
            <ul class="menu-list"><li>
        <a class="is-flex" href="#The-Importance-of-the-Normal-Distribution">
        <span class="has-mr-6">1</span>
        <span>The Importance of the Normal Distribution</span>
        </a></li><li>
        <a class="is-flex" href="#Generating-Normal-Random-Variables">
        <span class="has-mr-6">2</span>
        <span>Generating Normal Random Variables</span>
        </a></li><li>
        <a class="is-flex" href="#Inverse-Transform-Sampling">
        <span class="has-mr-6">3</span>
        <span>Inverse Transform Sampling</span>
        </a><ul class="menu-list"><li>
        <a class="is-flex" href="#A-Theoretical-Background">
        <span class="has-mr-6">3.1</span>
        <span>A Theoretical Background</span>
        </a></li><li>
        <a class="is-flex" href="#The-Intuition">
        <span class="has-mr-6">3.2</span>
        <span>The Intuition</span>
        </a></li><li>
        <a class="is-flex" href="#A-Concrete-Example">
        <span class="has-mr-6">3.3</span>
        <span>A Concrete Example</span>
        </a></li><li>
        <a class="is-flex" href="#Application-to-the-Normal-Distribution">
        <span class="has-mr-6">3.4</span>
        <span>Application to the Normal Distribution</span>
        </a></li></ul></li><li>
        <a class="is-flex" href="#Implementing-the-method">
        <span class="has-mr-6">4</span>
        <span>Implementing the method</span>
        </a><ul class="menu-list"><li>
        <a class="is-flex" href="#The-Algorithm">
        <span class="has-mr-6">4.1</span>
        <span>The Algorithm</span>
        </a></li><li>
        <a class="is-flex" href="#Verification">
        <span class="has-mr-6">4.2</span>
        <span>Verification</span>
        </a></li><li>
        <a class="is-flex" href="#Benchmarking">
        <span class="has-mr-6">4.3</span>
        <span>Benchmarking</span>
        </a></li></ul></li><li>
        <a class="is-flex" href="#Next-Steps-The-Box-Muller-Transform">
        <span class="has-mr-6">5</span>
        <span>Next Steps: The Box-Muller Transform</span>
        </a></li></ul>
        </div>
    </div>
</div>

    
    
        <div class="column-right-shadow is-hidden-widescreen ">
        
            
<div class="card widget">
    <div class="card-content">
        <h3 class="menu-label">
            Recent
        </h3>
        
        <article class="media">
            
            <a href="/tribute-to-conway/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/gallery/thumbnails/tribute-to-conway.jpg" alt="The Look-and-Say Sequence: A Tribute to John Conway">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2020-04-17T23:00:00.000Z">2020-04-18</time></div>
                    <a href="/tribute-to-conway/" class="has-link-black-ter is-size-6">The Look-and-Say Sequence: A Tribute to John Conway</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/Mathematics/">Mathematics</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/ditch-mnist/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/gallery/thumbnails/ditch-mnist.jpg" alt="Is it Time to Ditch the MNIST Dataset?">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2020-04-04T23:00:00.000Z">2020-04-05</time></div>
                    <a href="/ditch-mnist/" class="has-link-black-ter is-size-6">Is it Time to Ditch the MNIST Dataset?</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/Data-Science/">Data Science</a> / <a class="has-link-grey -link" href="/categories/Data-Science/Best-Practice/">Best Practice</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/excel-abuse-peaceable-queens/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/gallery/thumbnails/excel-abuse-peaceable-queens.png" alt="Excel Abuse: Peaceable Queens">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2020-03-22T00:00:00.000Z">2020-03-22</time></div>
                    <a href="/excel-abuse-peaceable-queens/" class="has-link-black-ter is-size-6">Excel Abuse: Peaceable Queens</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/Operational-Research/">Operational Research</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/guide-to-love/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/gallery/thumbnails/guide-to-love.jpg" alt="A Statistican&#39;s Guide to Love">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2020-02-14T00:00:00.000Z">2020-02-14</time></div>
                    <a href="/guide-to-love/" class="has-link-black-ter is-size-6">A Statistican&#39;s Guide to Love</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/Statistics/">Statistics</a> / <a class="has-link-grey -link" href="/categories/Statistics/Probability/">Probability</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/strange-timezones/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/gallery/thumbnails/strange-timezones.jpg" alt="An Analysis of Strange Timezones">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2020-01-25T00:00:00.000Z">2020-01-25</time></div>
                    <a href="/strange-timezones/" class="has-link-black-ter is-size-6">An Analysis of Strange Timezones</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/Data-Science/">Data Science</a> / <a class="has-link-grey -link" href="/categories/Data-Science/Visualisation/">Visualisation</a>
                    </p>
                </div>
            </div>
        </article>
        
    </div>
</div>

        
            
<div class="card widget">
    <div class="card-content">
        <div class="menu">
            <h3 class="menu-label">
                Categories
            </h3>
            <ul class="menu-list">
            <li>
        <a class="level is-marginless" href="/categories/Computer-Science/">
            <span class="level-start">
                <span class="level-item">Computer Science</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">4</span>
            </span>
        </a><ul><li>
        <a class="level is-marginless" href="/categories/Computer-Science/Algorithms/">
            <span class="level-start">
                <span class="level-item">Algorithms</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/Computer-Science/Cloud-Computing/">
            <span class="level-start">
                <span class="level-item">Cloud Computing</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/Computer-Science/Coding-Problems/">
            <span class="level-start">
                <span class="level-item">Coding Problems</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">2</span>
            </span>
        </a></li></ul></li><li>
        <a class="level is-marginless" href="/categories/Data-Science/">
            <span class="level-start">
                <span class="level-item">Data Science</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">13</span>
            </span>
        </a><ul><li>
        <a class="level is-marginless" href="/categories/Data-Science/Best-Practice/">
            <span class="level-start">
                <span class="level-item">Best Practice</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">3</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/Data-Science/Machine-Learning/">
            <span class="level-start">
                <span class="level-item">Machine Learning</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/Data-Science/Preprocessing/">
            <span class="level-start">
                <span class="level-item">Preprocessing</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/Data-Science/Visualisation/">
            <span class="level-start">
                <span class="level-item">Visualisation</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">7</span>
            </span>
        </a></li></ul></li><li>
        <a class="level is-marginless" href="/categories/Mathematics/">
            <span class="level-start">
                <span class="level-item">Mathematics</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">3</span>
            </span>
        </a><ul><li>
        <a class="level is-marginless" href="/categories/Mathematics/Analysis/">
            <span class="level-start">
                <span class="level-item">Analysis</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/Mathematics/Combinatorics/">
            <span class="level-start">
                <span class="level-item">Combinatorics</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li></ul></li><li>
        <a class="level is-marginless" href="/categories/Meta/">
            <span class="level-start">
                <span class="level-item">Meta</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">2</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/Operational-Research/">
            <span class="level-start">
                <span class="level-item">Operational Research</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">3</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/Statistics/">
            <span class="level-start">
                <span class="level-item">Statistics</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">5</span>
            </span>
        </a><ul><li>
        <a class="level is-marginless" href="/categories/Statistics/Probability/">
            <span class="level-start">
                <span class="level-item">Probability</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">5</span>
            </span>
        </a></li></ul></li><li>
        <a class="level is-marginless" href="/categories/System/">
            <span class="level-start">
                <span class="level-item">System</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/Visualisation/">
            <span class="level-start">
                <span class="level-item">Visualisation</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a><ul><li>
        <a class="level is-marginless" href="/categories/Visualisation/Interactive/">
            <span class="level-start">
                <span class="level-item">Interactive</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li></ul></li>
            </ul>
        </div>
    </div>
</div>
        
            
<div class="card widget">
    <div class="card-content">
        <h3 class="menu-label">
            Tag Cloud
        </h3>
        <a href="/tags/animation/" style="font-size: 15px;">animation</a> <a href="/tags/bank-holiday-bodge/" style="font-size: 13.75px;">bank-holiday-bodge</a> <a href="/tags/benchmarking/" style="font-size: 11.25px;">benchmarking</a> <a href="/tags/binomial-distribution/" style="font-size: 10px;">binomial-distribution</a> <a href="/tags/clustering/" style="font-size: 10px;">clustering</a> <a href="/tags/coins/" style="font-size: 10px;">coins</a> <a href="/tags/combinatorical-optimisation/" style="font-size: 10px;">combinatorical optimisation</a> <a href="/tags/combinatorics/" style="font-size: 11.25px;">combinatorics</a> <a href="/tags/data-mining/" style="font-size: 12.5px;">data-mining</a> <a href="/tags/dimensionality-reduction/" style="font-size: 10px;">dimensionality-reduction</a> <a href="/tags/ethics/" style="font-size: 10px;">ethics</a> <a href="/tags/excel/" style="font-size: 11.25px;">excel</a> <a href="/tags/gcp/" style="font-size: 10px;">gcp</a> <a href="/tags/graph-theory/" style="font-size: 10px;">graph-theory</a> <a href="/tags/hypothesis-testing/" style="font-size: 10px;">hypothesis-testing</a> <a href="/tags/integration/" style="font-size: 10px;">integration</a> <a href="/tags/lesson/" style="font-size: 11.25px;">lesson</a> <a href="/tags/linear-algebra/" style="font-size: 10px;">linear-algebra</a> <a href="/tags/linear-programming/" style="font-size: 11.25px;">linear-programming</a> <a href="/tags/linux/" style="font-size: 10px;">linux</a> <a href="/tags/magrittr/" style="font-size: 10px;">magrittr</a> <a href="/tags/no-coding/" style="font-size: 18.75px;">no-coding</a> <a href="/tags/normal-distribution/" style="font-size: 10px;">normal-distribution</a> <a href="/tags/number-theory/" style="font-size: 10px;">number-theory</a> <a href="/tags/probabilistic-method/" style="font-size: 10px;">probabilistic-method</a> <a href="/tags/probability/" style="font-size: 10px;">probability</a> <a href="/tags/problem-solving/" style="font-size: 11.25px;">problem-solving</a> <a href="/tags/python/" style="font-size: 16.25px;">python</a> <a href="/tags/r/" style="font-size: 17.5px;">r</a> <a href="/tags/reflection/" style="font-size: 10px;">reflection</a> <a href="/tags/reinforcement-learning/" style="font-size: 10px;">reinforcement-learning</a> <a href="/tags/shiny/" style="font-size: 12.5px;">shiny</a> <a href="/tags/simulation/" style="font-size: 12.5px;">simulation</a> <a href="/tags/solver/" style="font-size: 11.25px;">solver</a> <a href="/tags/sports/" style="font-size: 10px;">sports</a> <a href="/tags/story/" style="font-size: 13.75px;">story</a> <a href="/tags/tidyverse/" style="font-size: 12.5px;">tidyverse</a> <a href="/tags/tutorial/" style="font-size: 20px;">tutorial</a> <a href="/tags/visualisation/" style="font-size: 11.25px;">visualisation</a> <a href="/tags/web-development/" style="font-size: 10px;">web-development</a>
    </div>
</div>

        
        </div>
    
</div>

                




<div class="column is-4-tablet is-4-desktop is-3-widescreen is-hidden-touch is-hidden-desktop-only has-order-3 column-right ">
    
        
<div class="card widget">
    <div class="card-content">
        <h3 class="menu-label">
            Recent
        </h3>
        
        <article class="media">
            
            <a href="/tribute-to-conway/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/gallery/thumbnails/tribute-to-conway.jpg" alt="The Look-and-Say Sequence: A Tribute to John Conway">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2020-04-17T23:00:00.000Z">2020-04-18</time></div>
                    <a href="/tribute-to-conway/" class="has-link-black-ter is-size-6">The Look-and-Say Sequence: A Tribute to John Conway</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/Mathematics/">Mathematics</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/ditch-mnist/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/gallery/thumbnails/ditch-mnist.jpg" alt="Is it Time to Ditch the MNIST Dataset?">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2020-04-04T23:00:00.000Z">2020-04-05</time></div>
                    <a href="/ditch-mnist/" class="has-link-black-ter is-size-6">Is it Time to Ditch the MNIST Dataset?</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/Data-Science/">Data Science</a> / <a class="has-link-grey -link" href="/categories/Data-Science/Best-Practice/">Best Practice</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/excel-abuse-peaceable-queens/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/gallery/thumbnails/excel-abuse-peaceable-queens.png" alt="Excel Abuse: Peaceable Queens">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2020-03-22T00:00:00.000Z">2020-03-22</time></div>
                    <a href="/excel-abuse-peaceable-queens/" class="has-link-black-ter is-size-6">Excel Abuse: Peaceable Queens</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/Operational-Research/">Operational Research</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/guide-to-love/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/gallery/thumbnails/guide-to-love.jpg" alt="A Statistican&#39;s Guide to Love">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2020-02-14T00:00:00.000Z">2020-02-14</time></div>
                    <a href="/guide-to-love/" class="has-link-black-ter is-size-6">A Statistican&#39;s Guide to Love</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/Statistics/">Statistics</a> / <a class="has-link-grey -link" href="/categories/Statistics/Probability/">Probability</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/strange-timezones/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/gallery/thumbnails/strange-timezones.jpg" alt="An Analysis of Strange Timezones">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2020-01-25T00:00:00.000Z">2020-01-25</time></div>
                    <a href="/strange-timezones/" class="has-link-black-ter is-size-6">An Analysis of Strange Timezones</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/Data-Science/">Data Science</a> / <a class="has-link-grey -link" href="/categories/Data-Science/Visualisation/">Visualisation</a>
                    </p>
                </div>
            </div>
        </article>
        
    </div>
</div>

    
        
<div class="card widget">
    <div class="card-content">
        <div class="menu">
            <h3 class="menu-label">
                Categories
            </h3>
            <ul class="menu-list">
            <li>
        <a class="level is-marginless" href="/categories/Computer-Science/">
            <span class="level-start">
                <span class="level-item">Computer Science</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">4</span>
            </span>
        </a><ul><li>
        <a class="level is-marginless" href="/categories/Computer-Science/Algorithms/">
            <span class="level-start">
                <span class="level-item">Algorithms</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/Computer-Science/Cloud-Computing/">
            <span class="level-start">
                <span class="level-item">Cloud Computing</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/Computer-Science/Coding-Problems/">
            <span class="level-start">
                <span class="level-item">Coding Problems</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">2</span>
            </span>
        </a></li></ul></li><li>
        <a class="level is-marginless" href="/categories/Data-Science/">
            <span class="level-start">
                <span class="level-item">Data Science</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">13</span>
            </span>
        </a><ul><li>
        <a class="level is-marginless" href="/categories/Data-Science/Best-Practice/">
            <span class="level-start">
                <span class="level-item">Best Practice</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">3</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/Data-Science/Machine-Learning/">
            <span class="level-start">
                <span class="level-item">Machine Learning</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/Data-Science/Preprocessing/">
            <span class="level-start">
                <span class="level-item">Preprocessing</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/Data-Science/Visualisation/">
            <span class="level-start">
                <span class="level-item">Visualisation</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">7</span>
            </span>
        </a></li></ul></li><li>
        <a class="level is-marginless" href="/categories/Mathematics/">
            <span class="level-start">
                <span class="level-item">Mathematics</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">3</span>
            </span>
        </a><ul><li>
        <a class="level is-marginless" href="/categories/Mathematics/Analysis/">
            <span class="level-start">
                <span class="level-item">Analysis</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/Mathematics/Combinatorics/">
            <span class="level-start">
                <span class="level-item">Combinatorics</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li></ul></li><li>
        <a class="level is-marginless" href="/categories/Meta/">
            <span class="level-start">
                <span class="level-item">Meta</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">2</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/Operational-Research/">
            <span class="level-start">
                <span class="level-item">Operational Research</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">3</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/Statistics/">
            <span class="level-start">
                <span class="level-item">Statistics</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">5</span>
            </span>
        </a><ul><li>
        <a class="level is-marginless" href="/categories/Statistics/Probability/">
            <span class="level-start">
                <span class="level-item">Probability</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">5</span>
            </span>
        </a></li></ul></li><li>
        <a class="level is-marginless" href="/categories/System/">
            <span class="level-start">
                <span class="level-item">System</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/Visualisation/">
            <span class="level-start">
                <span class="level-item">Visualisation</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a><ul><li>
        <a class="level is-marginless" href="/categories/Visualisation/Interactive/">
            <span class="level-start">
                <span class="level-item">Interactive</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li></ul></li>
            </ul>
        </div>
    </div>
</div>
    
        
<div class="card widget">
    <div class="card-content">
        <h3 class="menu-label">
            Tag Cloud
        </h3>
        <a href="/tags/animation/" style="font-size: 15px;">animation</a> <a href="/tags/bank-holiday-bodge/" style="font-size: 13.75px;">bank-holiday-bodge</a> <a href="/tags/benchmarking/" style="font-size: 11.25px;">benchmarking</a> <a href="/tags/binomial-distribution/" style="font-size: 10px;">binomial-distribution</a> <a href="/tags/clustering/" style="font-size: 10px;">clustering</a> <a href="/tags/coins/" style="font-size: 10px;">coins</a> <a href="/tags/combinatorical-optimisation/" style="font-size: 10px;">combinatorical optimisation</a> <a href="/tags/combinatorics/" style="font-size: 11.25px;">combinatorics</a> <a href="/tags/data-mining/" style="font-size: 12.5px;">data-mining</a> <a href="/tags/dimensionality-reduction/" style="font-size: 10px;">dimensionality-reduction</a> <a href="/tags/ethics/" style="font-size: 10px;">ethics</a> <a href="/tags/excel/" style="font-size: 11.25px;">excel</a> <a href="/tags/gcp/" style="font-size: 10px;">gcp</a> <a href="/tags/graph-theory/" style="font-size: 10px;">graph-theory</a> <a href="/tags/hypothesis-testing/" style="font-size: 10px;">hypothesis-testing</a> <a href="/tags/integration/" style="font-size: 10px;">integration</a> <a href="/tags/lesson/" style="font-size: 11.25px;">lesson</a> <a href="/tags/linear-algebra/" style="font-size: 10px;">linear-algebra</a> <a href="/tags/linear-programming/" style="font-size: 11.25px;">linear-programming</a> <a href="/tags/linux/" style="font-size: 10px;">linux</a> <a href="/tags/magrittr/" style="font-size: 10px;">magrittr</a> <a href="/tags/no-coding/" style="font-size: 18.75px;">no-coding</a> <a href="/tags/normal-distribution/" style="font-size: 10px;">normal-distribution</a> <a href="/tags/number-theory/" style="font-size: 10px;">number-theory</a> <a href="/tags/probabilistic-method/" style="font-size: 10px;">probabilistic-method</a> <a href="/tags/probability/" style="font-size: 10px;">probability</a> <a href="/tags/problem-solving/" style="font-size: 11.25px;">problem-solving</a> <a href="/tags/python/" style="font-size: 16.25px;">python</a> <a href="/tags/r/" style="font-size: 17.5px;">r</a> <a href="/tags/reflection/" style="font-size: 10px;">reflection</a> <a href="/tags/reinforcement-learning/" style="font-size: 10px;">reinforcement-learning</a> <a href="/tags/shiny/" style="font-size: 12.5px;">shiny</a> <a href="/tags/simulation/" style="font-size: 12.5px;">simulation</a> <a href="/tags/solver/" style="font-size: 11.25px;">solver</a> <a href="/tags/sports/" style="font-size: 10px;">sports</a> <a href="/tags/story/" style="font-size: 13.75px;">story</a> <a href="/tags/tidyverse/" style="font-size: 12.5px;">tidyverse</a> <a href="/tags/tutorial/" style="font-size: 20px;">tutorial</a> <a href="/tags/visualisation/" style="font-size: 11.25px;">visualisation</a> <a href="/tags/web-development/" style="font-size: 10px;">web-development</a>
    </div>
</div>

    
    
</div>

            </div>
        </div>
    </section>
    <footer class="footer">
    <div class="container">
        <div class="level">
            <div class="level-start has-text-centered-mobile">
                <a class="footer-logo is-block has-mb-6" href="/">
                
                    <img src="/images/logo.png" alt="Generating Normal Random Variables - Part 1: Inverse Transform Sampling" height="28">
                
                </a>
                <p class="is-size-7">
                &copy; 2020 Tim Hargreaves&nbsp;
                Powered by <a href="https://hexo.io/" target="_blank">Hexo</a> & <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank">Icarus</a>
                
                </p>
            </div>
            <div class="level-end">
            
                <div class="field has-addons is-flex-center-mobile has-mt-5-mobile is-flex-wrap is-flex-middle">
                
                
                <p class="control">
                    <a class="button is-white is-large" target="_blank" title="Creative Commons" href="https://creativecommons.org/">
                        
                        <i class="fab fa-creative-commons"></i>
                        
                    </a>
                </p>
                
                <p class="control">
                    <a class="button is-white is-large" target="_blank" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/">
                        
                        <i class="fab fa-creative-commons-by"></i>
                        
                    </a>
                </p>
                
                <p class="control">
                    <a class="button is-white is-large" target="_blank" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus">
                        
                        <i class="fab fa-github"></i>
                        
                    </a>
                </p>
                
                </div>
            
            </div>
        </div>
    </div>
</footer>
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script>
<script>moment.locale("en");</script>

<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.19/css/jquery.dataTables.css">
<script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/1.10.19/js/jquery.dataTables.js"></script>


    
    
    
    <script src="/js/animation.js"></script>
    

    
    
    
    <script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script>
    <script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script>
    <script src="/js/gallery.js" defer></script>
    

    
    

<div id="outdated">
    <h6>Your browser is out-of-date!</h6>
    <p>Update your browser to view this website correctly. <a id="btnUpdateBrowser" href="http://outdatedbrowser.com/">Update
            my browser now </a></p>
    <p class="last"><a href="#" id="btnCloseUpdateBrowser" title="Close">&times;</a></p>
</div>
<script src="https://cdn.jsdelivr.net/npm/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.js" defer></script>
<script>
    document.addEventListener("DOMContentLoaded", function () {
        outdatedBrowser({
            bgColor: '#f25648',
            color: '#ffffff',
            lowerThan: 'flex'
        });
    });
</script>


    
    
<script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.5/unpacked/MathJax.js?config=TeX-MML-AM_CHTML" defer></script>
<script>
document.addEventListener('DOMContentLoaded', function () {
    MathJax.Hub.Config({
        'HTML-CSS': {
            matchFontHeight: false
        },
        SVG: {
            matchFontHeight: false
        },
        CommonHTML: {
            matchFontHeight: false
        },
        tex2jax: {
            inlineMath: [
                ['$','$'],
                ['\\(','\\)']
            ]
        }
    });
});
</script>

    
    

<a id="back-to-top" title="Back to Top" href="javascript:;">
    <i class="fas fa-chevron-up"></i>
</a>
<script src="/js/back-to-top.js" defer></script>


    
    

    
    
    
    

    
    
    
    
    
    <script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script>
    <script src="/js/clipboard.js" defer></script>
    

    
    
    


<script src="/js/main.js" defer></script>

    
    <div class="searchbox ins-search">
    <div class="searchbox-container ins-search-container">
        <div class="searchbox-input-wrapper">
            <input type="text" class="searchbox-input ins-search-input" placeholder="Type something...">
            <span class="searchbox-close ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="searchbox-result-wrapper ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
    (function (window) {
        var INSIGHT_CONFIG = {
            TRANSLATION: {
                POSTS: 'Posts',
                PAGES: 'Pages',
                CATEGORIES: 'Categories',
                TAGS: 'Tags',
                UNTITLED: '(Untitled)',
            },
            CONTENT_URL: '/content.json',
        };
        window.INSIGHT_CONFIG = INSIGHT_CONFIG;
    })(window);
</script>
<script src="/js/insight.js" defer></script>
<link rel="stylesheet" href="/css/search.css">
<link rel="stylesheet" href="/css/insight.css">
    
</body>
</html>